---
layout: post
title: 2nd Difference Formula Proof
date: 2025-12-10
categories: math, 2nd difference, second difference, proof, derivation, recursion, closed-form solution
permalink: /2nd-diff
---

## 1. Preamble<a name="preamble"></a>

During junior high school, I was introduced to a formula for finding the n<sup>th</sup> term of a certain sequence with a second difference that went something like:

T<sub>n</sub> = 1/2(n)<sup>2</sup> - 1/2(n) + 1, for a sequence `1, 2, 4, 7 ...` and n >= 1.

At first, the formula seemed quite random (similar to the quadratic formula) and I could not wrap my head around it at the time.

I wondered how adding a second difference could make the trivial arithmetic formula so complex, and I was inspired by a textbook I was reading ("Concrete Mathematics" by Donald Knuth), so I tried to derive the formula myself.
I also did not like to use things I did not understand, and there is no better way to understand something than to make it yourself from scratch.

I wrote this blog post to share in hopes that someone may find it useful.

## 2. What is a 2<sup>nd</sup> Difference?

Say there is a sequence `1, 2, 4, 7 ...`.
You may have come across quite a few of these types of sequences on IQ tests and whatnot, and it is easy to find that the fifth term is 11 and so on.

However, it is obvious at a glance that the sequence does not follow the familiar arithmetic or geometric formulas, so we cannot yet find an arbitrary n<sup>th</sup> term of the sequence without knowing the previous terms.
Finding the general formula for this will be the goal of this derivation.

The difference or ratio between every term and its subsequent term is not constant, unlike what is needed for a+(n-1)d or ar<sup>n-1</sup> to work properly.
Instead, the difference (which we will now call the 'first difference') increases by a constant amount as the sequence goes on.

We can see this clearly if we construct a new sequence from the first differences:

T<sub>2</sub> - T<sub>1</sub> = 2 - 1 = 1;

T<sub>3</sub> - T<sub>2</sub> = 4 - 2 = 2;

T<sub>4</sub> - T<sub>3</sub> = 7 - 4 = 3;

...

so the sequence of first differences is:

`1, 2, 3 ...`.

Unlike the original sequence, it is easy to see that this sequence has a constant difference of one, so the n<sup>th</sup> term can be found using the familiar formula (albeit with some notation modifications):

(d<sub>1</sub>)<sub>n</sub> = a<sub>2</sub> + (n - 1)d<sub>2</sub>, for n >= 1,

where (d<sub>1</sub>)<sub>n</sub> is the n<sup>th</sup> first difference, a<sub>2</sub> is the first term of the sequence of first differences (a<sub>1</sub> would be the first term of the original sequence), and d<sub>2</sub> is the difference for the sequence of first differences (or the second difference).

## 3. Derivation of the Formula

Using the approach we naturally used to find that 11 was the fifth term in the original sequence earlier, we can model the sequence as a recursive problem:

T<sub>1</sub> = a<sub>1</sub>;

T<sub>n</sub> = T<sub>n-1</sub> + (d<sub>1</sub>)<sub>n-1</sub>, for n >= 2.

Note that it is (d<sub>1</sub>)<sub>n-1</sub> and not (d<sub>1</sub>)<sub>n</sub> because the 1<sup>st</sup> term of the first difference is

(d<sub>1</sub>)<sub>1</sub> = T<sub>2</sub> - T<sub>1</sub> = 2 - 1 = 1,

so it is

(d<sub>1</sub>)<sub>n</sub> = T<sub>n+1</sub> - T<sub>n</sub>

and not

(d<sub>1</sub>)<sub>n</sub> = T<sub>n</sub> - T<sub>n-1</sub>.

Moving on, we expand---or "unfold"---the recursive formula to try and spot some patterns we could use to find a closed-form solution:

T<sub>n</sub> = T<sub>n-1</sub> + (d<sub>1</sub>)<sub>n-1</sub>

= T<sub>n-2</sub> + (d<sub>1</sub>)<sub>n-2</sub> + (d<sub>1</sub>)<sub>n-1</sub>

= T<sub>n-3</sub> + (d<sub>1</sub>)<sub>n-3</sub> + (d<sub>1</sub>)<sub>n-2</sub> + (d<sub>1</sub>)<sub>n-1</sub>.

...

Although not particularly useful by itself, there is an easy to spot pattern:

T<sub>n</sub> = T<sub>n-k</sub> + (d<sub>1</sub>)<sub>n-k</sub> + (d<sub>1</sub>)<sub>n-(k-1)</sub> + (d<sub>1</sub>)<sub>n-(k-2)</sub> + ... + (d<sub>1</sub>)<sub>n-2</sub> + (d<sub>1</sub>)<sub>n-1</sub>, for 1 <= k < n.

Now if we unfold all the way (k = n - 1):

T<sub>n</sub> = T<sub>n-(n-1)</sub> + (d<sub>1</sub>)<sub>n-(n-1)</sub> + (d<sub>n-(n-2)</sub>)<sub>2</sub> + (d<sub>1</sub>)<sub>n-(n-3)</sub> + ... + (d<sub>1</sub>)<sub>n-2</sub> + (d<sub>1</sub>)<sub>n-1</sub>

= T<sub>1</sub> + (d<sub>1</sub>)<sub>1</sub> + (d<sub>1</sub>)<sub>2</sub> + (d<sub>1</sub>)<sub>3</sub> + ... + (d<sub>1</sub>)<sub>n-2</sub> + (d<sub>1</sub>)<sub>n-1</sub>

= a<sub>1</sub> + (d<sub>1</sub>)<sub>1</sub> + (d<sub>1</sub>)<sub>2</sub> + (d<sub>1</sub>)<sub>3</sub> + ... + (d<sub>1</sub>)<sub>n-2</sub> + (d<sub>1</sub>)<sub>n-1</sub>.

Substituing the formula for finding the n<sup>th</sup> term in the sequence of first differences:

T<sub>n</sub> = a<sub>1</sub> + (a<sub>2</sub> + (1 - 1)d<sub>2</sub>) + (a<sub>2</sub> + (2 - 1)d<sub>2</sub>) + (a<sub>2</sub> + (3 - 1)d<sub>2</sub>) + ... + (a<sub>2</sub> + ((n - 1) - 1)d<sub>2</sub>)

= a<sub>1</sub> + a<sub>2</sub> + (1 - 1)d<sub>2</sub> + a<sub>2</sub> + (2 - 1)d<sub>2</sub> + ... + a<sub>2</sub> + ((n - 2) - 1)d<sub>2</sub> + a<sub>2</sub> + ((n - 1) - 1)d<sub>2</sub>.

Since it goes from (d<sub>1</sub>)<sub>1</sub> to (d<sub>1</sub>)<sub>n-1</sub>, there will be (n - 1) number of a<sub>2</sub>'s on the right-hand side of the equation:

T<sub>n</sub> = a<sub>1</sub> + (n - 1)a<sub>2</sub> + (1 - 1)d<sub>2</sub> + (2 - 1)d<sub>2</sub> + ... + ((n - 2) - 1)d<sub>2</sub> + ((n - 1) - 1)d<sub>2</sub>.

Attempting to factorise the remaining open-form part into d<sub>2</sub>, we can start to spot a pattern:

T<sub>n</sub> = a<sub>1</sub> + (n - 1)a<sub>2</sub> + ((1 - 1) + (2 - 1) + ... + ((n - 2) - 1) + ((n - 1) - 1))d<sub>2</sub>.

Again, because it goes from (d<sub>1</sub>)<sub>1</sub> to (d<sub>1</sub>)<sub>n-1</sub>, there will be (n - 1) number of (-1)'s:

T<sub>n</sub> = a<sub>1</sub> + (n - 1)a<sub>2</sub> + ((1 + 2 + 3 + ... + (n - 3) + (n - 2) + (n - 1)) + (n - 1)(-1))d<sub>2</sub>.

Now the pattern is easier to see. It is the sum of integers to (n - 1):

T<sub>n</sub> = a<sub>1</sub> + (n - 1)a<sub>2</sub> + (S<sub>n-1</sub> + (n - 1)(-1))d<sub>2</sub>

= a<sub>1</sub> + (n - 1)a<sub>2</sub> + (S<sub>n-1</sub> - (n - 1))d<sub>2</sub>.

Luckily for us, the great mathematician Gauss found a closed-form solution for finding the sum of integers to n when he was apparently 9 years-old or something (dubious):

T<sub>n</sub> = a<sub>1</sub> + (n - 1)a<sub>2</sub> + (1/2(n - 1)((n - 1) + 1) - (n - 1))d<sub>2</sub>

= a<sub>1</sub> + (n - 1)a<sub>2</sub> + (1/2(n - 1)(n) - (n - 1))d<sub>2</sub>

= a<sub>1</sub> + (n - 1)a<sub>2</sub> + 1/2(n - 2)(n - 1)d<sub>2</sub>.

The above is the closed-form solution of the general formula for finding the n<sup>th</sup> term of a sequence with a 2<sup>nd</sup> difference.
We can test it against the earlier sequence that we used as an example (`1, 2, 4, 7 ...`):

T<sub>n</sub> = a<sub>1</sub> + (n - 1)a<sub>2</sub> + 1/2(n - 2)(n - 1)d<sub>2</sub>

= 1 + (n - 1)(1) + 1/2(n - 2)(n - 1)(1), for a<sub>1</sub> = 1, a<sub>2</sub> = 1, d<sub>2</sub> = 1

= 1 + (n - 1) + 1/2(n - 2)(n - 1)

= n + 1/2(n - 2)(n - 1)

= n + 1/2(n<sup>2</sup> - 3n + 2)

= n + 1/2n<sup>2</sup> - 3/2(n) + 1

= 1/2(n)<sup>2</sup> - 1/2(n) + 1.

Which matches what I wrote on the [preamble](/2nd-diff#preamble).
You can try out a few examples to check for any counter-examples, but you will not know for certain if it will always be correct unless you prove it, which will be talked about in the next section.

## 4. Proof by Mathematical Induction

Continuing from the previous section: the derivation makes sense, and we can try a few examples, but how do we know for sure that there is no counter-example somewhere we did not check?
We need to be mathematically rigorous to show our formula will always work.

Fortunately, there is a convenient method called "proof by induction" that fits nicely for our sequences situation.
If we show that our formula is true for a base case and also that it is true for any n if it was true for (n - 1), we can confidently conclude that the formula is true for all n.

### 4.1 Induction Step<a name="step"></a>

Let us first go back to our definitions:

T<sub>1</sub> = a<sub>1</sub>;

T<sub>n</sub> = T<sub>n-1</sub> + (d<sub>1</sub>)<sub>n-1</sub>, for n >= 2;

(d<sub>1</sub>)<sub>n</sub> = a<sub>2</sub> + (n - 1)d<sub>2</sub>, for n >= 1.

The formula we derived and want to prove is

T<sub>n</sub> = a<sub>1</sub> + (n - 1)a<sub>2</sub> + 1/2(n - 2)(n - 1)d<sub>2</sub>.

Plugging in the formula we derived, but for T<sub>n-1</sub>:

T<sub>n</sub> = a<sub>1</sub> + ((n - 1) - 1)a<sub>2</sub> + 1/2((n - 1) - 2)((n - 1) - 1)d<sub>2</sub> + (d<sub>1</sub>)<sub>n-1</sub>

= a<sub>1</sub> + (n - 2)a<sub>2</sub> + 1/2(n - 3)(n - 2)d<sub>2</sub> + (d<sub>1</sub>)<sub>n-1</sub>

= a<sub>1</sub> + (n - 2)a<sub>2</sub> + 1/2(n - 3)(n - 2)d<sub>2</sub> + (a<sub>2</sub> + ((n - 1) - 1)d<sub>2</sub>)

= a<sub>1</sub> + (n - 2)a<sub>2</sub> + 1/2(n - 3)(n - 2)d<sub>2</sub> + (a<sub>2</sub> + (n - 2)d<sub>2</sub>)

= a<sub>1</sub> + (n - 2)a<sub>2</sub> + a<sub>2</sub> + 1/2(n - 3)(n - 2)d<sub>2</sub> + (n - 2)d<sub>2</sub>

= a<sub>1</sub> + (n - 1)a<sub>2</sub> + 1/2(n - 3)(n - 2)d<sub>2</sub> + (n - 2)d<sub>2</sub>

= a<sub>1</sub> + (n - 1)a<sub>2</sub> + (1/2(n - 3) + 1)(n - 2)d<sub>2</sub>

= a<sub>1</sub> + (n - 1)a<sub>2</sub> + ((n - 3)/2 + 2/2)(n - 2)d<sub>2</sub>

= a<sub>1</sub> + (n - 1)a<sub>2</sub> + (((n - 3) + 2)/2)(n - 2)d<sub>2</sub>

= a<sub>1</sub> + (n - 1)a<sub>2</sub> + (((n - 3) + 2)/2)(n - 2)d<sub>2</sub>

= a<sub>1</sub> + (n - 1)a<sub>2</sub> + ((n - 1)/2)(n - 2)d<sub>2</sub>

= a<sub>1</sub> + (n - 1)a<sub>2</sub> + 1/2(n - 1)(n - 2)d<sub>2</sub>

= a<sub>1</sub> + (n - 1)a<sub>2</sub> + 1/2(n - 2)(n - 1)d<sub>2</sub>

That matches our formula, and hence proves that the formula will hold true for any n if (n - 1) is true.
However, we are still missing our base case (n = 1), which is covered in the next subsection.

### 4.2 Base Case

Plugging in the formula for T<sub>1</sub>:

T<sub>1</sub> = a<sub>1</sub> + (n - 1)a<sub>2</sub> + 1/2(n - 2)(n - 1)d<sub>2</sub>

= a<sub>1</sub> + (1 - 1)a<sub>2</sub> + 1/2(1 - 2)(1 - 1)d<sub>2</sub>, for n = 1

= a<sub>1</sub> + (0)a<sub>2</sub> + 1/2(-1)(0)d<sub>2</sub>, for n = 1

= a<sub>1</sub> + 0 + 0

= a<sub>1</sub>.

Which matches our definition, and hence proves that the formula is true for n = 1.
Combining that with the earlier [induction step](/2nd-diff#step), we get that it is also true for n = 2, n - 1 = 1.
Then that also shows that the formula is true for n = 3, n - 1 = 2.
This then continues on infinitely, which shows that our formula holds true for any n.

QED.

## 5. Conclusion

So thats the derivation and proof of the formula for finding the n<sup>th</sup> term of a sequence with a second difference.
Hopefully after reading through all that, you have gained a better understanding of how sequences with 2<sup>nd</sup> differences work.

<script src="https://giscus.app/client.js"
        data-repo="de-soot/de-soot.github.io"
        data-repo-id="R_kgDOK6_5tA"
        data-category="Announcements"
        data-category-id="DIC_kwDOK6_5tM4CflCT"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>
